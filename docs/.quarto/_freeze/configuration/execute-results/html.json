{
  "hash": "ebab9a3b42b10cae5f11ffda70b39502",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Configuration file guide\"\nsubtitle: 'Guide for creating and modifying necessary configuration files'\n---\n\n\n\n\n\nRunning __*agate*__ requires configuration files. Each of these are plain text files that end with .cnf and can be edited in any text editor or in MATLAB's Editor window. \n\n1. An overview [**mission configuration file**](#mission-configuration-file) is required for all __*agate*__ processes. A different mission configuration file is created for each glider and mission and it contains settings for glider metadata, paths, acoustic system settings, and plotting options.\n2. A [**basestation configuration file**](#basestation-configuration-file) with SSH login info - only required if using __*agate*__ to interact directly with the basestation. This is a separate configuration file because it does not change between missions and should be stored in a secure directory on your local computer and not shared with others. \n\n\n## Mission configuration file\n\nAn example configuration file is located in the `agate/settings` folder: [`agate_config_example.cnf`](https://github.com/sfregosi/agate/blob/main/agate/settings/agate_config_example.cnf)\n\nThe configuration file has settings for the glider and mission, paths to relevant input and output folders, map extent and plotting settings, and acoustic system settings. Lines starting with `%` are comments. \n\nThe top section is [required](#required-configuration-settings) to initialize __*agate*__ and use the most basic functions. The remaining sections are optional depending on what __*agate*__ functionality is desired, including interfacing with the [basestation](), working with [acoustic]() data outputs, and [plotting maps](). Save this file with a unique name for each glider and mission. Descriptions of each configuration item are included in the example file as comments. \n\nTo suggest additional configuration items, please open an [issue](https://github.com/sfregosi/agate/issues/new){target='_blank'}.\n\n<sub>[Back to top](#)</sub>\n\n#### Required configuration settings\n\nThe top section `% %%%% REQUIRED CONFIG PARAMETERS %%%%%%%%%%%` is required to initialize __*agate*__ and use the most basic functions. Explanations for each parameter are in the example configuration file as comments.\n\n```matlab\nCONFIG.glider = 'sgXXX'; % glider serial number\nCONFIG.mission = 'Location_Mon20XX'; % mission identifier defined in sg_calib_constants.m \nCONFIG.sgVer = XX.XX; % 66.12 or 67.0, firmware version displayed on glider start up\nCONFIG.tmd = XX; % target mission duration in days\n\n% define paths\n% mission path - path to umbrella folder that either contains previously \n%                downloaded basestation and output files or will contain \n%                downloaded and processed/produced files and figures\nCONFIG.path.mission = 'C:\\Users\\User.Name\\Desktop\\sgXXX_Location_Mon20XX\\';\n% analysis path - optional path to an 'analysis' folder that would typically\n%                 contain the outputs of acoustic analyses (e.g., Pamguard\n%                 or Triton)\nCONFIG.path.analysis = 'C:\\Users\\User.Name\\project\\analysis';\n```\n\n#### Optional basestation settings\n\n```matlab\n% %%%% OPTIONAL - basestation %%%%%%%%%%%%%%%\n% specify basestation configuration file\nCONFIG.bs.cnfFile = 'C:\\Users\\User.Name\\Documents\\gliders\\basestation.cnf';\n% specify path to store downloaded basestation files\nCONFIG.path.bsLocal = fullfile(CONFIG.path.mission, 'basestationFiles\\');\n% specify path to remote files (e.g., glider's current/mission folder)\nCONFIG.path.bsRemote = '/home/jails/group/gliderjail/home/sgXXX/current';\n```\n\n#### Optional acoustics settings\n\nVarious settings required to operate an acoustic system or to process acoustic data after a mission is over. Depending on which acoustic system is installed, only PMAR or WISPR settings are needed. Unneeded lines can be deleted or ignored by adding a `%` at the start of the line.\n\n```matlab\n% %%%% OPTIONAL - acoustics %%%%%%%%%%%%%%%%%\n```\n\nFor PMAR, some settings are required during a mission to track remaining memory available. The conversion settings are only required after a mission is complete to convert .dat to .wav and should be turned off after conversion is done. The processing and analysis settings are only needed after a mission is complete. \n\n```matlab\n% PMAR settings\nCONFIG.pm.loggers = 0; % 1 for active, 0 for inactive\nCONFIG.pm.activeCard = 0; % current active card; optional for sgVer 66.12 \n                          % (will be updated in log file automatically);\n                          % necessary to update throughout mission for sgVer 67.0\nCONFIG.pm.numCards = 4; % total number loaded SD cards\n% after mission is complete, set below for raw .dat file conversion\nCONFIG.pm.convert = 0; % 0 during mission or analysis, set 1 to run conversion\nCONFIG.pm.convCnfFile = fullfile(CONFIG.path.mission, 'PMARConvert_sgXXX_Location_MonYYYY.cnf');\n% after mission is complete, set below for data processing/analysis\nCONFIG.pm.fileLength = 600; % in seconds\nCONFIG.pm.sampleRate = 180260; % sample rate\nCONFIG.pm.dateFormat = 'yyMMdd-HHmmss.SSS';\nCONFIG.pm.dateStart = 19; % what character of file name starts the date format\n% example file name: sg639_MHI_Apr2023_230411-185050.484.wav\n```\n\nWISPR settings are only required for processing and analysis after a mission is complete; there is no __*agate*__-based piloting interaction with the WISPR system at this time. The settings define input and output paths and extensions for file conversion and the format of the timestamp in filenames for needed for summarizing recording effort in time and space. \n\n```matlab\n% WISPR settings\n% only needed after mission is complete (no piloting functionality for WISPR)\nCONFIG.ws.loggers = 0; % 1 for active, 0 for inactive\nCONFIG.ws.inDir = 'D:\\sgXXX_Location_Mon20XX_raw_acoustic_data';   % path to raw .dat files\nCONFIG.ws.outDir = 'E:\\sgXXX_Location_Mon20XX\\flac';   % path to save converted files\nCONFIG.ws.outExt = '.flac';   % determines output format\nCONFIG.ws.fileLength = 60; % in seconds\nCONFIG.ws.dateFormat = 'yyMMdd_HHmmss'; % format of timestamp in filename\nCONFIG.ws.dateStart = 7; % character of filename where date starts\n% example file name: WISPR_230504_202206.flac\n```\n\n#### Optional plotting settings\n\nIf using __*agate*__ for plotting during a mission or for analysis and processing after, it is useful to set some plot settings and paths so they don't have to be repeatedly manually modified. \n\n```matlab\n% %%%% OPTIONAL - plotting %%%%%%%%%%%%%%%%%%\n```\n\nFor mapping: \n\n```matlab\n% maps\n% path to basemap files (land shape files and bathymetry rasters)\nCONFIG.path.shp = 'C:\\Users\\User.Name\\Documents\\GIS\\';\n% optional: can specify full path to bathymetry file, otherwise agate \n% will prompt to select file\nCONFIG.map.bathyFile =  'C:\\Users\\User.Name\\Documents\\GIS\\etopo\\etopo1_ice_g_i2.bin';\n% define map extents and location of map elements\nCONFIG.map.latLim = [000.00 000.00];\nCONFIG.map.lonLim = [-000.00 -000.00];\nCONFIG.map.naLat = 00.00; % optional arguments for north arrow location on map; \n                          % leave empty '[]' for no north arrow\nCONFIG.map.naLon = 000.00;\nCONFIG.map.scalePos = [0 0]; % optional arguments for scale bar location \n                             % and ticks, leave empty '[]' for no scale bar\nCONFIG.map.scaleMajor = [0:50:100];\nCONFIG.map.scaleMinor = [0:12.5:25];\n```\n\nFor piloting related plots:\n\n```matlab\n% piloting plot settings\n% pre allocate fig numbers so figures are updated rather than created new\nCONFIG.plots.figSeed = 111; % suggest using the glider serial e.g., 639\nCONFIG.plots.figNumList = CONFIG.plots.figSeed + [0 1 2 3 4 5 6 7 8 9]; \n% figNumList (1) = battery, (2) = voltagePackUse, (3) = humidity\n% and pressure, (4) = map, (5) = zoomed map, (6) = minimum voltage, \n% (7) = voltage normalized, (8) = ERMA detections, (9) = ERMA reference\n\n% load plot positions \n% load('C:\\Users\\User.Name\\Documents\\gliders\\figPositions.mat');\n% CONFIG.plots.positions = positions;\n```\n\n<sub>[Back to top](#)</sub>\n\n## Basestation configuration file\n\nThe path and file name for basestation configuration file is specified with `CONFIG.bs.cnfFile` in the mission configuration file. An example is located in the `agate/settings` folder: [`basestation_example.cnf`](https://github.com/sfregosi/agate/blob/main/agate/settings/basestation_example.cnf). \n\nThis is a separate configuration file because it typically does not change between missions and gliders and contains potentially sensitive information for the SSH connection to a research group's basestation. This file should be stored somewhere central and safe, preferably outside of the GitHub repository for security reasons. This file must contain the below lines, with the inputs updated for a particular basestation. It can work with basestation access via a username and password or a username and SSH key pair to authenticate; the one not used should just be excluded or commented out with a `%`.\n\n```matlab\nCONFIG.bs.host = 'url.com';\nCONFIG.bs.username = 'pilot';\n\n% authenticate via password\nCONFIG.bs.password = 'PsWrD';\n% OR key pair\nCONFIG.bs.publicKeyFile  = 'C:/Users/User.Name/.ssh/myPublicKey.pub';\nCONFIG.bs.privateKeyFile = 'C:/Users/User.Name/.ssh/myPrivateKey';\n```\n\n<sub>[Back to top](#)</sub>\n\n<!-- ## Acoustic conversion configuration files -->\n\n<!-- A conversion configuration file is necessary for converting raw acoustic data to .wav or .flac formats. There are different configuration files for the PMAR and for the WISPR systems. They provide information on conversion settings and file paths. The conversion configuration file is specified within the mission configuration file, and so is parsed by the initial `agate` call and the mission configuration.  -->\n\n\n<!-- ### PMAR conversion configuration file -->\n\n<!-- An example configuration file is located in the `agate/settings` folder: [`pmarConvert_example.cnf`](https://github.com/sfregosi/agate/blob/main/agate/settings/pmarConvert_example.cnf) -->\n\n<!-- Lines starting with `%` are comments. All parameters are added to the existing `CONFIG` structure, under a nested `pm` structure. All the changeable parameters are listed/grouped at the top, but there is additional detail about each parameter as comments below. These detailed descriptions include some additional example inputs and the default settings.  -->\n\n\n<!-- - `CONFIG.pm.inDir`: path to raw PMAR `.dat` files. These can be within subdirectories by dive (the default write method of PMAR) -->\n<!-- - `CONFIG.pm.outDir`: path to folder to save converted `.wav` files -->\n<!-- - `CONFIG.outTemplate`: filename template for the converted files. It must have a `%s` that becomes a date/time stamp, and an appropriate file extension (`.wav` or `.flac`) -->\n<!-- - `CONFIG.pm.showProgress`: set to `true` to display progress in the Command Window -->\n<!-- - `CONFIG.pm.restartDir`: location to start processing. Set to `''` (empty) to start at the beginning and process all directories. Otherwise, specify a single dive/phase directory (e.g., 'pm0006a') to start at that point in the mission. This is used if there are errors so you don't have to start over at the beginning -->\n<!-- - `CONFIG.pm.decim`: set a decimation factor (integer), or set to `0` for no decimation -->\n<!-- - `CONFIG.pm.relativeCutoffFreq`: if decimating, need to set a value from 0 to 1 to specifiy a filter cut off (relative to Nyquist). This is only used if `CONFIG.pm.decim > 2` -->\n<!-- - `CONFIG.pm.forceSRate`: set to force the output sample rate to the specified sample rate. This is necessary for PMAR because the sample rate can vary slightly from file to file (by a decimal Hz) which can lead to later analysis issues (e.g., making LTSAs)  -->\n\n\n<!-- <sub>[Back to top](#)</sub> -->\n\n<!-- ### WISPR conversion configuration file -->\n\n<!-- **UNDER CONSTRUCTION** -->\n\n<!-- An example configuration file is located in the `agate/settings` folder: [`wisprConvert_example.cnf`](https://github.com/sfregosi/agate/blob/main/agate/settings/wisprConvert_example.cnf) -->\n\n<!-- Lines starting with `%` are comments. All parameters are added to the existing `CONFIG` structure, under a nested `ws` structure. All the changeable parameters are listed/grouped at the top,but there is additional detail about each parameter as comments below. These detailed descriptions include some additional example inputs and the default settings.  -->\n\n\n<sub>[Back to top](#)</sub>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}